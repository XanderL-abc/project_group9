Algorithm 2 was done by Juan Martinez Vasquez